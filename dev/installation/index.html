<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Installation · ACEtb.jl Documentation</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="ACEtb.jl Documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ACEtb.jl Documentation</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../intro/">Introduction</a></li><li><a class="tocitem" href="../gettingstarted/">Getting Started</a></li><li class="is-active"><a class="tocitem" href>Installation</a><ul class="internal"><li><a class="tocitem" href="#ACEtb.jl-Installation"><span>ACEtb.jl Installation</span></a></li><li><a class="tocitem" href="#Testing-ACEtb.jl-installation"><span>Testing ACEtb.jl installation</span></a></li><li><a class="tocitem" href="#Installing-DFTB-with-ACEtb"><span>Installing DFTB+ with ACEtb</span></a></li></ul></li><li><span class="tocitem">ACEtb Model</span><ul><li><a class="tocitem" href="../acetb_intro/">What is ACEtb Model</a></li><li><a class="tocitem" href="../fitting/">How to fit ACEtb Model</a></li><li><a class="tocitem" href="../acetb_usage/">Basic Usage</a></li></ul></li><li><span class="tocitem">ACEtb API: <code>lib_acetb</code></span><ul><li><a class="tocitem" href="../dftbplus_acetb/">DFTB+ Integration</a></li></ul></li><li><a class="tocitem" href="../devel/">Developer Docs</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Installation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Installation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ACEsuit/ACEtb.jl/blob/master/docs/src/installation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h1><p>The installation instructions here include steps for both ACEtb.jl package and <code>lib_acetb</code> API compilation in DFTB+ code.</p><h2 id="ACEtb.jl-Installation"><a class="docs-heading-anchor" href="#ACEtb.jl-Installation">ACEtb.jl Installation</a><a id="ACEtb.jl-Installation-1"></a><a class="docs-heading-anchor-permalink" href="#ACEtb.jl-Installation" title="Permalink"></a></h2><p>ACEtb.jl is a pure Julia code and can be directly installed using the Julia package following the instructions below. We recommend Julia with version 1.5 and higher to use with ACEtb.jl package as the code is only tested with version 1.5 and higher (as of now, we also tested it with 1.6).</p><pre><code class="nohighlight hljs">] add https://github.com/ACEsuit/ACEtb.jl.git</code></pre><p>Here, <code>]</code> indicates that REPL is in <code>pkg</code> mode at Julia.</p><h2 id="Testing-ACEtb.jl-installation"><a class="docs-heading-anchor" href="#Testing-ACEtb.jl-installation">Testing ACEtb.jl installation</a><a id="Testing-ACEtb.jl-installation-1"></a><a class="docs-heading-anchor-permalink" href="#Testing-ACEtb.jl-installation" title="Permalink"></a></h2><p>ACEtb package includes several unit tests that can be run using Julia <code>pkg</code> testing command as follows:</p><pre><code class="nohighlight hljs">] test ACEtb</code></pre><h2 id="Installing-DFTB-with-ACEtb"><a class="docs-heading-anchor" href="#Installing-DFTB-with-ACEtb">Installing DFTB+ with ACEtb</a><a id="Installing-DFTB-with-ACEtb-1"></a><a class="docs-heading-anchor-permalink" href="#Installing-DFTB-with-ACEtb" title="Permalink"></a></h2><p>DFTB+ integration of ACEtb needs the compilation of <code>lib_acetb</code> (currently, within DFTB+) code. This section only covers the installation of DFTB+ with ACEtb module and will not provide information on how DFTB+ is compiled with its other modules. If you are interested in the detailed explanation of how the integration is done, please check DFTB+ Integration section.</p><h3 id="Dependencies-of-DFTB-and-lib_acetb"><a class="docs-heading-anchor" href="#Dependencies-of-DFTB-and-lib_acetb">Dependencies of DFTB+ and <code>lib_acetb</code></a><a id="Dependencies-of-DFTB-and-lib_acetb-1"></a><a class="docs-heading-anchor-permalink" href="#Dependencies-of-DFTB-and-lib_acetb" title="Permalink"></a></h3><p>As well as Julia with version 1.5 and higher is needed and ACEtb is installed in main environment (@v1.5 or equivalent in Julia REPL), the following libraries are also needed to compile DFTB+.</p><p>Libraries:</p><ul><li>OpenBLAS</li><li>MPI (Ex.: OpenMPI. Only if parallelisation of DFTB+ is needed.)</li><li>ScaLAPACK (Only needed if DFTB+ is compiled with MPI)</li></ul><h4 id="Installing-Dependencies-at-macOS"><a class="docs-heading-anchor" href="#Installing-Dependencies-at-macOS">Installing Dependencies at macOS</a><a id="Installing-Dependencies-at-macOS-1"></a><a class="docs-heading-anchor-permalink" href="#Installing-Dependencies-at-macOS" title="Permalink"></a></h4><p>The dependencies may be installed using Homebrew with the following commands:</p><pre><code class="nohighlight hljs">brew install openblas
brew install openmpi
brew install scalapack</code></pre><h4 id="Installing-Dependencies-at-Linux-(Ubuntu)"><a class="docs-heading-anchor" href="#Installing-Dependencies-at-Linux-(Ubuntu)">Installing Dependencies at Linux (Ubuntu)</a><a id="Installing-Dependencies-at-Linux-(Ubuntu)-1"></a><a class="docs-heading-anchor-permalink" href="#Installing-Dependencies-at-Linux-(Ubuntu)" title="Permalink"></a></h4><p>The dependencies may be installed using Homebrew with the following commands:</p><pre><code class="nohighlight hljs">apt-get update
apt-get install make build-essential g++ gfortran
apt-get install libblas-dev liblapack-dev libopenmpi-dev libscalapack-mpi-dev openmpi-bin</code></pre><h3 id="Installation-of-DFTB-with-WITH_ACETBTRUE-for-lib_acetb"><a class="docs-heading-anchor" href="#Installation-of-DFTB-with-WITH_ACETBTRUE-for-lib_acetb">Installation of DFTB+ with <code>WITH_ACETB=TRUE</code> for <code>lib_acetb</code></a><a id="Installation-of-DFTB-with-WITH_ACETBTRUE-for-lib_acetb-1"></a><a class="docs-heading-anchor-permalink" href="#Installation-of-DFTB-with-WITH_ACETBTRUE-for-lib_acetb" title="Permalink"></a></h3><h4 id="Compiling-DFTB-Serial"><a class="docs-heading-anchor" href="#Compiling-DFTB-Serial">Compiling DFTB+ Serial</a><a id="Compiling-DFTB-Serial-1"></a><a class="docs-heading-anchor-permalink" href="#Compiling-DFTB-Serial" title="Permalink"></a></h4><p>In <code>dftbplus</code> directory of DFTB+ repository, run the following commands:</p><pre><code class="nohighlight hljs">mkdir build
cd build
cmake -DWITH_ACETB=TRUE ..
make
make install</code></pre><p>Make sure that the configuration step of CMake run includes the following outputs where Julia and LAPACK libraries are found:</p><pre><code class="nohighlight hljs"></code></pre><p>In case LAPACK libraries cannot be found by CMake, specify the correct library path using <code>-DLAPACK_LIBRARY_DIRS</code> as following:</p><pre><code class="nohighlight hljs">cmake -DWITH_ACETB=TRUE -DLAPACK_LIBRARY_DIRS=/usr/local/opt/openblas/lib ..</code></pre><p>Here, <code>/usr/local/opt/openblas/lib</code> is the OpenBLAS library path that is installed by Homebrew at macOS. Cange the directory accordingly to match your system&#39;s installation path.</p><h4 id="Compiling-DFTB-Parallel-using-MPI"><a class="docs-heading-anchor" href="#Compiling-DFTB-Parallel-using-MPI">Compiling DFTB+ Parallel using MPI</a><a id="Compiling-DFTB-Parallel-using-MPI-1"></a><a class="docs-heading-anchor-permalink" href="#Compiling-DFTB-Parallel-using-MPI" title="Permalink"></a></h4><p>Here we assume you use OpenMPI library. In case you would like to use Intel MPI or MPICH, make sure CMake can find the correct library paths.</p><p>A typical command to compile DFTB+ with MPI is as follows</p><pre><code class="nohighlight hljs">cmake -DWITH_MPI=TRUE -DWITH_ACETB=TRUE ..
make
make install</code></pre><p>With the above parameters, CMake try to find the ScaLAPACK library by looking at the default locations and names. In case, the installed ScaLAPACK library may have a different name and path in your system, you may need to explicitly specify the correct name of ScaLAPACK library and path. This can be done using the following flags:</p><pre><code class="nohighlight hljs">cmake -DWITH_MPI=TRUE -DWITH_ACETB=TRUE -DLAPACK_LIBRARY_DIRS=/usr/local/opt/openblas/lib -DSCALAPACK_LIBRARIES=&quot;scalapack&quot; -DSCALAPACK_LIBRARY=&quot;scalapack&quot; -DSCALAPACK_LIBRARY_DIRS=/usr/local/opt/scalapack/lib ..</code></pre><p>Here, ScaLAPACK library name is specified with <code>scalapack</code> and hence CMake try to find <code>libscalapack.so</code> in the directory that is given with <code>-DSCALAPACK_LIBRARY_DIRS</code>.</p><h3 id="Setting-Python-interface"><a class="docs-heading-anchor" href="#Setting-Python-interface">Setting Python interface</a><a id="Setting-Python-interface-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-Python-interface" title="Permalink"></a></h3><p>As we did not specify a system-wide installation path above, DFTB+ and its Python iterface <code>dptools</code> will only be installed in the <code>build/install</code> directory where <code>build</code> is the dorectory we run <code>cmake</code>. </p><p>To add the path of the installed <code>dptools</code> Python module to the Python path, you need to use the following command:</p><pre><code class="nohighlight hljs">export PYTHONPATH=$PYTHONPATH:$HOME/dftbplus/build/install/lib/python3.9/site-packages</code></pre><p>The above command assumes that you download DFTB+ repository (<code>dftbplus</code>) into your home directory and <code>cmake</code> found Python 3.9 in your system. To make sure the path is added to Python module paths in all shell instances, add the above line to your <code>~/.bashrc</code> and <code>~/.bash_profile</code> (for macOS, <code>~/.profile</code>) with</p><pre><code class="nohighlight hljs">cat &quot;export PYTHONPATH=$PYTHONPATH:$HOME/dftbplus/build/install/lib/python3.9/site-packages&quot; &gt;&gt; ~/.bashrc
cat &quot;export PYTHONPATH=$PYTHONPATH:$HOME/dftbplus/build/install/lib/python3.9/site-packages&quot; &gt;&gt; ~/.bash_profile
source ~/.bash_profile</code></pre><h3 id="Adding-DFTB-to-System-Path"><a class="docs-heading-anchor" href="#Adding-DFTB-to-System-Path">Adding DFTB+ to System Path</a><a id="Adding-DFTB-to-System-Path-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-DFTB-to-System-Path" title="Permalink"></a></h3><p>Running the following lines at command line will add the <code>bin</code> directory of installation to the system-wide paths. Once the commands below are issued, executables of DFTB+ such as <code>dftb+</code> and <code>dp_bands</code> can be run directly at any path.</p><pre><code class="nohighlight hljs">cat &quot;export PATH=$PATH:$HOME/dftbplus/build/install/bin/&quot; &gt;&gt; ~/.bashrc
cat &quot;export PATH=$PATH:$HOME/dftbplus/build/install/bin/&quot; &gt;&gt; ~/.bash_profile
source ~/.bash_profile</code></pre><h3 id="Running-the-code-(Serial)"><a class="docs-heading-anchor" href="#Running-the-code-(Serial)">Running the code (Serial)</a><a id="Running-the-code-(Serial)-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-code-(Serial)" title="Permalink"></a></h3><p>Several test configurations are provided in <code>test</code> directory of <code>lib_acetb</code> distribution. To test the code, enter to <code>test</code> directory where <code>dftb_in.hsd</code> file resides. To run the code serial, use the following command:</p><pre><code class="nohighlight hljs">dftb+</code></pre><h3 id="Running-the-code-with-Julia-Threads-(Parallel)"><a class="docs-heading-anchor" href="#Running-the-code-with-Julia-Threads-(Parallel)">Running the code with Julia Threads (Parallel)</a><a id="Running-the-code-with-Julia-Threads-(Parallel)-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-code-with-Julia-Threads-(Parallel)" title="Permalink"></a></h3><p>ACEtb benefits from Julia threads by distributing per-atom calculations to each thread. </p><p>Julia threads can be set by</p><pre><code class="nohighlight hljs">export JULIA_NUM_THREADS=4</code></pre><p>where <code>4</code> is the number of Julia threads that is used by each process. </p><p>Note: ACEtb does not use OpenMP Threads and hence setting <code>OMP_NUM_THREADS</code> does not have any effect.</p><h3 id="Running-the-code-with-MPI-(Parallel)"><a class="docs-heading-anchor" href="#Running-the-code-with-MPI-(Parallel)">Running the code with MPI (Parallel)</a><a id="Running-the-code-with-MPI-(Parallel)-1"></a><a class="docs-heading-anchor-permalink" href="#Running-the-code-with-MPI-(Parallel)" title="Permalink"></a></h3><p>DFTB+ benefits from MPI paralleisation not only by distributing per-atom calculations to each process but also used BLACS routines at ScaLAPACK. </p><p>Once DFTB+ is compiled with MPI support, you can run the code using the following command:</p><pre><code class="nohighlight hljs">mpirun -np 4 dftb+</code></pre><p>Note: Keep in mind that setting Julia Threads and using MPI will provide a mixed parallisation scheme and can benefit to speed up in multiple nodes. Example setting:</p><ul><li>For 2 nodes with 4 cores:</li></ul><pre><code class="nohighlight hljs">export JULIA_NUM_THREADS=4
mpirun -np 2 dftb+</code></pre><p>DFTB+ outputs these settings as following:</p><pre><code class="nohighlight hljs">Julia threads:               4
MPI processes:               2
OpenMP threads:              1</code></pre><p>See more information on parallelisation of DFTB+ at <a href="https://dftbplus-recipes.readthedocs.io/en/latest/parallel/compiling.html">Parallel usage of DFTB+</a></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gettingstarted/">« Getting Started</a><a class="docs-footer-nextpage" href="../acetb_intro/">What is ACEtb Model »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Monday 23 August 2021 13:13">Monday 23 August 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
